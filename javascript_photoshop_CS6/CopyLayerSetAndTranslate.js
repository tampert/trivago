/** * Created by Dirk Soentjens on 19/03/15. * Duplicate the default layer set and set the text layers to the right language */var translations_xml = [],          default_language = "DE",          picked_language;          function main() {    //Check if a document is open    if (!documents.length) return;    var originalUnit = preferences.rulerUnits;    preferences.rulerUnits = Units.PIXELS;    try {                var f = new File('~/Desktop/CEE_city_dealforms.xml');        f.open('r');        var xml = new XML( f.read() );        f.close();        translations_xml = xml;        ReadLanguages();    }catch (e) {        $.writeln(e);    }    preferences.rulerUnits = originalUnit;}main();function ReadLanguages(){    var len = translations_xml.children().length();    for(var i = 0; i < len; i++){          var len_cities = translations_xml.child(i).children().length();        for(var a = 0; a < len_cities; a++){            var country = translations_xml.child(i).localName(),             city = translations_xml.child(i).child(a),             newLayerSet = app.activeDocument.layers.getByName("default").duplicate();            for (var m = newLayerSet.layers.length - 1; m >= 0; m--){                newLayerSet.name = country + "-" + city;                 var theLayer = newLayerSet.layers[m];                 if (theLayer.kind == LayerKind.TEXT){                    theLayer.name = theLayer.name.replace("copy", country + "-" + city);                    theLayer.textItem.contents = city;                 }            }        }    }  }