/** * Created by Dirk Soentjens on 24/03/15.        Maybe: https://forums.adobe.com/message/4287129 or http://design.tutsplus.com/tutorials/create-a-calendar-using-scripting-in-photoshop--psd-7305 */function main() {    //Check if a document is open    if (!documents.length) return;    var originalUnit = preferences.rulerUnits;    preferences.rulerUnits = Units.PIXELS;    try {    var doc = app.activeDocument;    var imageUrl = File.openDialog ("Select file", "*.*", false);            //$.write(doc.height);        //$.write(doc.width);                if(imageUrl){            app.load (imageUrl);            backFile = app.activeDocument;            // backFile.resizeImage (600,1000);            backFile.selection.selectAll();            backFile.selection.copy();            backFile.close(SaveOptions.DONOTSAVECHANGES);            doc.paste();            doc.layers[0].name = "this is the new f*cking image!";        }    }catch (e) {        $.writeln(e);    }    preferences.rulerUnits = originalUnit;}main();